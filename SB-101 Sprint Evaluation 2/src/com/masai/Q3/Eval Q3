
mysql> CREATE TABLE customers (
    -> customer_id INT NOT NULL PRIMARY KEY,
    -> first_name VARCHAR(255) NOT NULL,
    -> last_name VARCHAR(255) NOT NULL,
    -> email VARCHAR(255) NOT NULL,
    -> address VARCHAR(255) DEFAULT NULL,
    -> city VARCHAR(255) DEFAULT NULL,
    -> state VARCHAR(2) DEFAULT NULL,
    -> zip_code VARCHAR(5) DEFAULT NULL
    -> );
 
 mysql> insert into customers values
    -> (1, 'abc', 'a', 'abc@mail.com', '1st Street', 'Chennai', 'TN', '60001'),
    -> (2, 'efg', 'e', 'efg@mail.com', '2nd Street', 'Bangalore', 'KA', '50002'),
    -> (3, 'ijk', 'i', 'ijk@mail.com', '3rd Street', 'Mumbai', 'MH', '40002')
    -> ;

mysql> select* from customers;
	+-------------+------------+-----------+--------------+------------+-----------+-------+----------+
	| customer_id | first_name | last_name | email        | address    | city      | state | zip_code |
	+-------------+------------+-----------+--------------+------------+-----------+-------+----------+
	|           1 | abc        | a         | abc@mail.com | 1st Street | Chennai   | TN    | 60001    |
	|           2 | efg        | e         | efg@mail.com | 2nd Street | Bangalore | KA    | 50002    |
	|           3 | ijk        | i         | ijk@mail.com | 3rd Street | Mumbai    | MH    | 40002    |
	+-------------+------------+-----------+--------------+------------+-----------+-------+----------+
    
 mysql> CREATE TABLE orders (
    -> order_id INT NOT NULL PRIMARY KEY,
    -> customer_id INT NOT NULL,
    -> order_placed_date DATE NOT NULL,
    -> FOREIGN KEY (customer_id) REFERENCES customers
    -> (customer_id)
    -> );
    

mysql> insert into orders values
	-> ( 1, 1, '2016-11-11'),
	-> ( 2, 1, '2016-10-01'),
    -> ( 3, 2, '2016-06-01'),
    -> ( 4, 2, '2015-06-01'),
    -> ( 5, 1, '2015-06-01')
    -> ;
    
    
mysql> select * from orders;
+----------+-------------+-------------------+
| order_id | customer_id | order_placed_date |
+----------+-------------+-------------------+
|        1 |           1 | 2016-11-11        |
|        2 |           1 | 2016-10-01        |
|        3 |           2 | 2016-06-01        |
|        4 |           2 | 2015-06-01        |
|        5 |           1 | 2015-06-01        |
+----------+-------------+-------------------+


mysql> select c.first_name, c.last_name, c.email,
    ->      COUNT(c.customer_id) as order_count
    ->      FROM
    ->      customers as c
    ->      INNER JOIN
    ->      orders o
    ->      ON
    ->      c.customer_id = o.customer_id
    ->      &&
    ->      o.order_placed_date > '2015-12-31'
    ->      GROUP BY
    ->      c.customer_id
    ->      ORDER BY
    ->      order_count
    ->      DESC;

OUTPUT:-
-------
+------------+-----------+--------------+-------------+
| first_name | last_name | email        | order_count |
+------------+-----------+--------------+-------------+
| abc        | a         | abc@mail.com |           2 |
| efg        | e         | efg@mail.com |           1 |
+------------+-----------+--------------+-------------+

		
